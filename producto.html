<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Producto | SpaceYisusShop</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <a href="index.html" class="logo">ü™ê SpaceYisusShop</a>
  </header>

  <main id="product-page" class="container">
    <section id="product-detail" class="product-detail">
      <div id="product-image-container">
        <img id="product-image" alt="Imagen del producto" />
      </div>
      <div class="product-info">
        <h1 id="product-name"></h1>
        <p id="product-description"></p>
        <h2 id="product-price"></h2>
        <button id="buy-button">üõí Comprar</button>
      </div>
    </section>

    <section id="related-products" class="related">
      <h3>Productos relacionados</h3>
      <div id="related-container" class="related-grid"></div>
    </section>
  </main>

  <footer>
    <p> 2025 SpaceYisusShop</p>
  </footer>

  <script>
// Funci√≥n para obtener producto desde API
async function getProductoById(id) {
    try {
        console.log('üîç Buscando producto:', id);
        const response = await fetch('/api/producto?id=' + id);
        
        if (!response.ok) {
            throw new Error('Producto no encontrado');
        }
        
        const product = await response.json();
        console.log('‚úÖ Producto encontrado:', product);
        return product;
    } catch (error) {
        console.error('‚ùå Error:', error);
        throw error;
    }
}

// Cuando la p√°gina carga
document.addEventListener('DOMContentLoaded', async function() {
    console.log('üìÑ P√°gina cargada');
    
    // Obtener ID de la URL
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get('id');
    console.log('üÜî ID del producto:', productId);

    if (!productId) {
        mostrarError('No se encontr√≥ ID del producto en la URL');
        return;
    }

    // Mostrar loading
    document.getElementById('product-detail').innerHTML = `
        <div style="text-align: center; padding: 50px;">
            <div class="spinner">‚è≥</div>
            <p>Cargando producto...</p>
        </div>
    `;

    try {
        // Obtener producto
        const product = await getProductoById(productId);
        mostrarProducto(product);
        
    } catch (error) {
        console.error('üí• Error:', error);
        mostrarError('Error: ' + error.message);
    }
});

function mostrarProducto(product) {
    const productImage = document.getElementById('product-image');
    const productName = document.getElementById('product-name');
    const productDescription = document.getElementById('product-description');
    const productPrice = document.getElementById('product-price');
    const buyButton = document.getElementById('buy-button');

    // Imagen
    if (product.imagen) {
        productImage.src = product.imagen;
        productImage.alt = product.nombre;
    }

    // Informaci√≥n
    productName.textContent = product.nombre || 'Producto';
    productDescription.textContent = product.descripcion || 'Sin descripci√≥n';
    productPrice.textContent = product.precio ? '$' + product.precio.toLocaleString('es-CO') : 'Consultar precio';

    // Bot√≥n de compra
    buyButton.onclick = function() {
        alert('Producto agregado al carrito: ' + product.nombre);
    };

    // Ocultar secci√≥n de relacionados si no hay datos
    document.getElementById('related-products').style.display = 'none';
}

function mostrarError(mensaje) {
    document.getElementById('product-detail').innerHTML = `
        <div style="text-align: center; padding: 50px; color: red;">
            <h2>üòï Producto no encontrado</h2>
            <p>${mensaje}</p>
            <a href="index.html" style="color: blue;">‚Üê Volver a la tienda</a>
        </div>
    `;
}
</script>
</body>
</html>

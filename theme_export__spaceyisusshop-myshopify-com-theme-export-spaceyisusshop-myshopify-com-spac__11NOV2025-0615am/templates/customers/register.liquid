{% comment %}
  Template: templates/customers/register.liquid
{% endcomment %}

<style>
  .auth-page {
    font-family: Arial, sans-serif;
    background: url('https://www.gureakdatapost.com/wp-content/uploads/2024/07/iStock-1281884522.jpg') no-repeat center center fixed;
    background-size: cover;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    position: relative;
    padding: 20px;
  }
  
  .auth-page::before {
    content: "";
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 0;
  }
  
  .auth-container {
    position: relative;
    z-index: 1;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    width: 100%;
    max-width: 420px;
  }
  
  .auth-container h2 {
    text-align: center;
    margin-bottom: 25px;
    color: #fff;
    font-size: 28px;
    font-weight: 300;
  }
  
  .form-group {
    margin-bottom: 18px;
  }
  
  .form-row {
    display: flex;
    gap: 10px;
  }
  
  .form-row .form-group {
    flex: 1;
  }
  
  .auth-container input[type="text"], 
  .auth-container input[type="email"], 
  .auth-container input[type="password"],
  .auth-container input[type="tel"] {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    font-size: 16px;
    box-sizing: border-box;
    backdrop-filter: blur(5px);
  }
  
  .auth-container input::placeholder {
    color: rgba(255, 255, 255, 0.7);
  }
  
  .auth-container input:focus {
    outline: none;
    border-color: rgba(255, 255, 255, 0.5);
    background: rgba(255, 255, 255, 0.15);
  }
  
  .auth-btn {
    width: 100%;
    padding: 12px;
    background: linear-gradient(135deg, #007BFF, #0056b3);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 500;
    transition: all 0.3s ease;
    margin-top: 10px;
  }
  
  .auth-btn:hover {
    background: linear-gradient(135deg, #0056b3, #004085);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4);
  }
  
  .toggle-link {
    text-align: center;
    margin-top: 20px;
  }
  
  .toggle-link a {
    text-decoration: none;
    color: rgba(255, 255, 255, 0.9);
    font-size: 14px;
    transition: color 0.3s ease;
  }
  
  .toggle-link a:hover {
    color: #fff;
    text-decoration: underline;
  }
  
  .error-message {
    background: rgba(255, 0, 0, 0.1);
    border: 1px solid rgba(255, 0, 0, 0.3);
    color: #ffcccc;
    text-align: center;
    font-size: 14px;
    margin: 15px 0;
    padding: 12px;
    border-radius: 8px;
    backdrop-filter: blur(5px);
  }
  
  .success-message {
    background: rgba(0, 255, 0, 0.1);
    border: 1px solid rgba(0, 255, 0, 0.3);
    color: #ccffcc;
    text-align: center;
    font-size: 14px;
    margin: 15px 0;
    padding: 12px;
    border-radius: 8px;
    backdrop-filter: blur(5px);
  }

  .password-strength {
    font-size: 12px;
    margin-top: 5px;
    color: rgba(255, 255, 255, 0.7);
  }
  
  .password-match-error {
    color: #ffcccc;
    font-size: 12px;
    margin-top: 5px;
    display: none;
  }

  /* Responsive */
  @media (max-width: 480px) {
    .auth-container {
      padding: 20px;
      margin: 10px;
    }
    
    .auth-container h2 {
      font-size: 24px;
    }
    
    .form-row {
      flex-direction: column;
      gap: 0;
    }
  }
</style>

<div class="auth-page">
  <div class="auth-container">
    <h2>Crear Cuenta</h2>
    
    {% form 'create_customer', return_to: routes.account_url %}
      <div class="form-row">
        <div class="form-group">
          <input 
            type="text" 
            name="customer[first_name]" 
            placeholder="Nombre" 
            value="{{ form.first_name }}"
            required
            autocomplete="given-name"
          >
        </div>
        
        <div class="form-group">
          <input 
            type="text" 
            name="customer[last_name]" 
            placeholder="Apellido" 
            value="{{ form.last_name }}"
            required
            autocomplete="family-name"
          >
        </div>
      </div>
      
      <div class="form-group">
        <input 
          type="email" 
          name="customer[email]" 
          placeholder="Correo electrónico" 
          value="{{ form.email }}"
          required
          autocomplete="email"
        >
      </div>
      
      <div class="form-group">
        <input 
          type="tel" 
          name="customer[phone]" 
          placeholder="Número de teléfono (opcional)" 
          value="{{ form.phone }}"
          autocomplete="tel"
        >
      </div>
      
      <div class="form-group">
        <input 
          type="password" 
          name="customer[password]" 
          placeholder="Contraseña" 
          id="password"
          required
          autocomplete="new-password"
          minlength="5"
        >
        <div class="password-strength" id="password-strength">
          La contraseña debe tener al menos 5 caracteres
        </div>
      </div>
      
      <div class="form-group">
        <input 
          type="password" 
          name="customer[password_confirmation]" 
          placeholder="Confirmar contraseña" 
          id="password-confirm"
          required
          autocomplete="new-password"
        >
        <div class="password-match-error" id="password-match-error">
          Las contraseñas no coinciden
        </div>
      </div>
      
      <button type="submit" class="auth-btn">Crear Cuenta</button>
    {% endform %}

    {% if form.errors %}
      <div class="error-message">
        {% for field in form.errors %}
          {% assign field_name = field | replace: 'form.', '' %}
          {% case field_name %}
            {% when 'email' %}
              El correo electrónico {{ form.errors.messages[field] | first }}
            {% when 'password' %}
              La contraseña {{ form.errors.messages[field] | first }}
            {% when 'password_confirmation' %}
              {{ form.errors.messages[field] | first }}
            {% else %}
              {{ form.errors.messages[field] | first }}
          {% endcase %}
        {% endfor %}
      </div>
    {% endif %}

    {% if form.posted_successfully? %}
      <div class="success-message">
        ¡Cuenta creada exitosamente! Te hemos enviado un email de verificación.
      </div>
      <script>
        setTimeout(function() {
          window.location.href = '{{ routes.account_login_url }}';
        }, 3000);
      </script>
    {% endif %}

    <div class="toggle-link">
      <a href="{{ routes.account_login_url }}">¿Ya tienes cuenta? Inicia sesión</a>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Animación de entrada
    const container = document.querySelector('.auth-container');
    container.style.opacity = '0';
    container.style.transform = 'translateY(20px)';
    
    setTimeout(function() {
      container.style.transition = 'all 0.5s ease';
      container.style.opacity = '1';
      container.style.transform = 'translateY(0)';
    }, 100);

    // Validación de contraseñas en tiempo real
    const password = document.getElementById('password');
    const passwordConfirm = document.getElementById('password-confirm');
    const passwordStrength = document.getElementById('password-strength');
    const passwordMatchError = document.getElementById('password-match-error');

    function checkPasswordStrength() {
      const value = password.value;
      const length = value.length;
      
      if (length === 0) {
        passwordStrength.textContent = 'La contraseña debe tener al menos 5 caracteres';
        passwordStrength.style.color = 'rgba(255, 255, 255, 0.7)';
      } else if (length < 5) {
        passwordStrength.textContent = `Faltan ${5 - length} caracteres más`;
        passwordStrength.style.color = '#ffcccc';
      } else if (length < 8) {
        passwordStrength.textContent = 'Contraseña aceptable - considera usar más caracteres';
        passwordStrength.style.color = '#ffffcc';
      } else {
        passwordStrength.textContent = 'Contraseña fuerte ✓';
        passwordStrength.style.color = '#ccffcc';
      }
    }

    function checkPasswordMatch() {
      if (passwordConfirm.value && password.value !== passwordConfirm.value) {
        passwordMatchError.style.display = 'block';
      } else {
        passwordMatchError.style.display = 'none';
      }
    }

    password.addEventListener('input', checkPasswordStrength);
    passwordConfirm.addEventListener('input', checkPasswordMatch);
    password.addEventListener('input', checkPasswordMatch);

    // Efecto de focus en inputs
    const inputs = document.querySelectorAll('input');
    inputs.forEach(input => {
      input.addEventListener('focus', function() {
        this.style.transform = 'scale(1.02)';
        this.style.transition = 'transform 0.2s ease';
      });
      
      input.addEventListener('blur', function() {
        this.style.transform = 'scale(1)';
      });
    });
  });
</script>